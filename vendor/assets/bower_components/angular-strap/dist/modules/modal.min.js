/**
 * angular-strap
 * @version v2.1.4 - 2014-11-26
 * @link http://mgcrea.github.io/angular-strap
 * @author Olivier Louvignes (olivier@mg-crea.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("mgcrea.ngStrap.modal",["mgcrea.ngStrap.helpers.dimensions"]).provider("$modal",function(){var n=this.defaults={animation:"am-fade",backdropAnimation:"am-fade",prefixClass:"modal",prefixEvent:"modal",placement:"top",template:"modal/modal.tpl.html",contentTemplate:!1,container:!1,element:null,backdrop:!0,keyboard:!0,html:!1,show:!0};this.$get=["$window","$rootScope","$compile","$q","$templateCache","$http","$animate","$timeout","$sce","dimensions",function(e,t,o,a,i,r,l,c,s){function u(e){function a(){b.$emit(u.prefixEvent+".show",c)}function i(){b.$emit(u.prefixEvent+".hide",c),g.removeClass(u.prefixClass+"-open"),u.animation&&g.removeClass(u.prefixClass+"-with-"+u.animation)}function r(n){n.target===n.currentTarget&&("static"===u.backdrop?c.focus():c.hide())}var c={},u=c.$options=angular.extend({},n,e);c.$promise=p(u.template);var b=c.$scope=u.scope&&u.scope.$new()||t.$new();u.element||u.container||(u.container="body"),f(["title","content"],function(n){u[n]&&(b[n]=s.trustAsHtml(u[n]))}),b.$hide=function(){b.$$postDigest(function(){c.hide()})},b.$show=function(){b.$$postDigest(function(){c.show()})},b.$toggle=function(){b.$$postDigest(function(){c.toggle()})},u.contentTemplate&&(c.$promise=c.$promise.then(function(n){var t=angular.element(n);return p(u.contentTemplate).then(function(n){var o=m('[ng-bind="content"]',t[0]).removeAttr("ng-bind").html(n);return e.template||o.next().remove(),t[0].outerHTML})}));var w,k,y=angular.element('<div class="'+u.prefixClass+'-backdrop"/>');return c.$promise.then(function(n){angular.isObject(n)&&(n=n.data),u.html&&(n=n.replace(v,'ng-bind-html="')),n=$.apply(n),w=o(n),c.init()}),c.init=function(){u.show&&b.$$postDigest(function(){c.show()})},c.destroy=function(){k&&(k.remove(),k=null),y&&(y.remove(),y=null),b.$destroy()},c.show=function(){if(!b.$isShown&&!b.$emit(u.prefixEvent+".show.before",c).defaultPrevented){var n,e;angular.isElement(u.container)?(n=u.container,e=u.container[0].lastChild?angular.element(u.container[0].lastChild):null):u.container?(n=m(u.container),e=n[0].lastChild?angular.element(n[0].lastChild):null):(n=null,e=u.element),k=c.$element=w(b,function(){}),k.css({display:"block"}).addClass(u.placement),u.animation&&(u.backdrop&&y.addClass(u.backdropAnimation),k.addClass(u.animation)),u.backdrop&&l.enter(y,g,null);var t=l.enter(k,n,e,a);t&&t.then&&t.then(a),c.$isShown=b.$isShown=!0,d(b);var o=k[0];h(function(){o.focus()}),g.addClass(u.prefixClass+"-open"),u.animation&&g.addClass(u.prefixClass+"-with-"+u.animation),u.backdrop&&(k.on("click",r),y.on("click",r)),u.keyboard&&k.on("keyup",c.$onKeyUp)}},c.hide=function(){if(b.$isShown&&!b.$emit(u.prefixEvent+".hide.before",c).defaultPrevented){var n=l.leave(k,i);n&&n.then&&n.then(i),u.backdrop&&l.leave(y),c.$isShown=b.$isShown=!1,d(b),u.backdrop&&(k.off("click",r),y.off("click",r)),u.keyboard&&k.off("keyup",c.$onKeyUp)}},c.toggle=function(){b.$isShown?c.hide():c.show()},c.focus=function(){k[0].focus()},c.$onKeyUp=function(n){27===n.which&&b.$isShown&&(c.hide(),n.stopPropagation())},c}function d(n){n.$$phase||n.$root&&n.$root.$$phase||n.$digest()}function m(n,e){return angular.element((e||document).querySelectorAll(n))}function p(n){return b[n]?b[n]:b[n]=a.when(i.get(n)||r.get(n)).then(function(e){return angular.isObject(e)?(i.put(n,e.data),e.data):e})}var f=angular.forEach,$=String.prototype.trim,h=e.requestAnimationFrame||e.setTimeout,g=angular.element(e.document.body),v=/ng-bind="/gi,b={};return u}]}).directive("bsModal",["$window","$sce","$modal",function(n,e,t){return{restrict:"EAC",scope:!0,link:function(n,o,a){var i={scope:n,element:o,show:!1};angular.forEach(["template","contentTemplate","placement","backdrop","keyboard","html","container","animation"],function(n){angular.isDefined(a[n])&&(i[n]=a[n])}),angular.forEach(["title","content"],function(t){a[t]&&a.$observe(t,function(o){n[t]=e.trustAsHtml(o)})}),a.bsModal&&n.$watch(a.bsModal,function(e){angular.isObject(e)?angular.extend(n,e):n.content=e},!0);var r=t(i);o.on(a.trigger||"click",r.toggle),n.$on("$destroy",function(){r&&r.destroy(),i=null,r=null})}}}]);
//# sourceMappingURL=modal.min.js.map